SQL> 
SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY
SQL> 
SQL> SELECT AVG(SALARY) FROM EMPLOYEES;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       8775                                                                                                                                                                                             

SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY TO DEPARTMENT 90
SQL> 
SQL> SELECT AVG(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = 90;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
 19333.3333                                                                                                                                                                                             

SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY TO EACH DEPARTMENT
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID ORDER BY 1;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           10        4400                                                                                                                                                                               
           20        9500                                                                                                                                                                               
           50        3500                                                                                                                                                                               
           60        6400                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
          110       10150                                                                                                                                                                               
                     7000                                                                                                                                                                               

8 rows selected.

SQL> REM DISPLAY HIGHEST AVERAGE SALARY PAID BY COMPANY TO DEPARTMENT
SQL> 
SQL> SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID ORDER BY 1;

MAX(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      19333.3333                                                                                                                                                                                        

SQL> SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MAX(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      19333.3333                                                                                                                                                                                        

SQL> REM DISPLAY DEPARTMENT_ID AND AVERAGE SALARY FOR THE DEPARTMENT TO WHICH HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> SELECT DEPARTMENT_ID , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT DEPARTMENT_ID , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = MAX(AVG(SALARY));
HAVING AVG(SALARY) = MAX(AVG(SALARY))
                         *
ERROR at line 2:
ORA-00935: group function is nested too deeply 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES);
HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES)
                                 *
ERROR at line 2:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               

SQL> REM 3 SUB QUERY CAN BE USEFUL WHEN WE WANT TO COMPARE NESTED SUMMARY ITEM IN 'HAVING' CLAUSE.
SQL> 
SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME      LAST_NAME       EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                     
----------- --------------- --------------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                     
        100 Steven          King            SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                     
        101 Neena           Kochhar         NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                     
        102 Lex             De Haan         LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                     
        103 Alexander       Hunold          AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                     
        104 Bruce           Ernst           BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                     
        107 Diana           Lorentz         DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                     
        124 Kevin           Mourgos         KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                     
        141 Trenna          Rajs            TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                     
        142 Curtis          Davies          CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                     
        143 Randall         Matos           RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                     
        144 Peter           Vargas                     650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                     
        149 Eleni           Zlotkey         EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                     
        174 Ellen           Abel            EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                     
        176 Jonathon        Taylor          JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                     
        178 Kimerely        Grant           KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                   
        200 Jennifer        Whalen          JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                     
        201 Michael         Hartstein       MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                     
        202 Pat             Fay             PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                     
        205 Shelley         Higgins         SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                     
        206 William         Gietz           WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                     

20 rows selected.

SQL> REM 1 DISPLAY MANAGER_ID AND TOTAL SALARY PAID FOR THE MANGER TO WHICH LOWEST TOTAL SALARY IS PAID
SQL> 
SQL> REM 2 DISPLAY JOB_ID AND COUNT OF EMPLOYEES FOR THE JOB FOR WHICH HIGHEST EMPLOYEES WORK
SQL> 
SQL> REM 3 DISPLAY DEPARTMENT_ID AND AVERAGE SALARY FOR THE DEPARTMENT TO WHICH EITHER LOWEST AVERAGE SALARY OF HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> REM 4 DISPLAY MANAGER_ID AND AVERAGE SALARY FOR ALL EXCEPT MANAGER TO WHICH HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> REM 5 DISPLAY JOB_ID AND TOTAL SALARY FOR ALL THE JOBS EXCEPT THOSE TO WHICH HIGHEST OR LOWEST TOTAL SALARY IS PAID
SQL> 
SQL> 
SQL> 
SQL> REM 1 DISPLAY MANAGER_ID AND TOTAL SALARY PAID FOR THE MANGER TO WHICH LOWEST TOTAL SALARY IS PAID
SQL> 
SQL> SELECT MANAGER_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY MANAGER_ID
  4  HAVING SUM(SALARY) IN (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
       201        6000                                                                                                                                                                                  

SQL> REM 2 DISPLAY JOB_ID AND COUNT OF EMPLOYEES FOR THE JOB FOR WHICH HIGHEST EMPLOYEES WORK
SQL> 
SQL> SELECT JOB_ID , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID       COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
ST_CLERK            4                                                                                                                                                                                   

SQL> REM 3 DISPLAY DEPARTMENT_ID AND AVERAGE SALARY FOR THE DEPARTMENT TO WHICH EITHER LOWEST AVERAGE SALARY OF HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> SELECT DEPATMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING AVG(SALARY) = (SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  5  OR     AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  6  
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING AVG(SALARY) = (SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  5  OR     AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
           50        3500                                                                                                                                                                               

SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING AVG(SALARY) IN ((SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  5                        ,(SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID));

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
           50        3500                                                                                                                                                                               

SQL> REM 4 DISPLAY MANAGER_ID AND AVERAGE SALARY FOR ALL EXCEPT MANAGER TO WHICH HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> SELECT MANAGER_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY MANAGER_ID
  4  HAVING AVG(SALARY) NOT IN (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
       100       12660                                                                                                                                                                                  
       149  8866.66667                                                                                                                                                                                  
       205        8300                                                                                                                                                                                  
       102        9000                                                                                                                                                                                  
       201        6000                                                                                                                                                                                  
       101        8200                                                                                                                                                                                  
       124        2925                                                                                                                                                                                  
       103        5100                                                                                                                                                                                  

8 rows selected.

SQL> REM 5 DISPLAY JOB_ID AND TOTAL SALARY FOR ALL THE JOBS EXCEPT THOSE TO WHICH HIGHEST OR LOWEST TOTAL SALARY IS PAID
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYES GROUP BY JOB_ID),
  5                             (SELECT MAX(SUM(SALARY)) FROM EMPLOYES GROUP BY JOB_ID));
HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYES GROUP BY JOB_ID),
                                                         *
ERROR at line 4:
ORA-00942: table or view does not exist 


SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYES GROUP BY JOB_ID),
  5  
SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID),
  5                             (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID));

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

10 rows selected.

SQL> REM 4 SUB QUERY CAN BE USED AS ONE OF THE TABLE FOR MAIN/OUTER QUERY.
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY) FROM EMPLOYEES
  2   GROUP BY JOB_ID
  3   HAVING SUM(SALARY) !=
  4   (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID) AND
  5  (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID) ;
(SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID) 
                                                        *
ERROR at line 5:
ORA-00936: missing expression 


SQL> SELECT JOB_ID , SUM(SALARY) FROM EMPLOYEES
  2   GROUP BY JOB_ID
  3   HAVING SUM(SALARY) !=
  4   (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID) AND
  5  SUM(SALARY) != (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID) ;

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

10 rows selected.

SQL> 
SQL> 
SQL> REM SUB QUERY CAN BE USED AS ONE OF THE TABLE FOR MAIN QUERY.
SQL> 
SQL> REM FROM table1 JOIN TYPE table2
SQL> 
SQL> REM DEPARTMENT_NAME , CITY
SQL> 
SQL> REM DEPARTMENTS       LOCATIONS
SQL> 
SQL> SELECT DEPARTMENT_ID , CITY
  2  FROM DEPARTMENTS
  3  NATURAL JOIN LOCATIONS;

DEPARTMENT_ID CITY                                                                                                                                                                                      
------------- ------------------------------                                                                                                                                                            
           10 Seattle                                                                                                                                                                                   
           20 Toronto                                                                                                                                                                                   
           50 South San Francisco                                                                                                                                                                       
           60 Southlake                                                                                                                                                                                 
           80 Oxford                                                                                                                                                                                    
           90 Seattle                                                                                                                                                                                   
          110 Seattle                                                                                                                                                                                   
          190 Seattle                                                                                                                                                                                   

8 rows selected.

SQL> SELECT DEPARTMENT_NAME, CITY
  2  FROM DEPARTMENTS
  3  NATURAL JOIN LOCATIONS;

DEPARTMENT_NAME                CITY                                                                                                                                                                     
------------------------------ ------------------------------                                                                                                                                           
Administration                 Seattle                                                                                                                                                                  
Marketing                      Toronto                                                                                                                                                                  
Shiping                        South San Francisco                                                                                                                                                      
IT                             Southlake                                                                                                                                                                
Sales                          Oxford                                                                                                                                                                   
Executive                      Seattle                                                                                                                                                                  
Accounting                     Seattle                                                                                                                                                                  
Contracting                    Seattle                                                                                                                                                                  

8 rows selected.

SQL> REM FIRST_NAME , DEPARTMENT_ID , SALARY
SQL> 
SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY
  2  FROM EMPLOYEES
  3  ORDER BY 2,3 DESC;

FIRST_NAME      DEPARTMENT_ID     SALARY                                                                                                                                                                
--------------- ------------- ----------                                                                                                                                                                
Jennifer                   10       4400                                                                                                                                                                
Michael                    20      13000                                                                                                                                                                
Pat                        20       6000                                                                                                                                                                
Kevin                      50       5800                                                                                                                                                                
Trenna                     50       3500                                                                                                                                                                
Curtis                     50       3100                                                                                                                                                                
Randall                    50       2600                                                                                                                                                                
Peter                      50       2500                                                                                                                                                                
Alexander                  60       9000                                                                                                                                                                
Bruce                      60       6000                                                                                                                                                                
Diana                      60       4200                                                                                                                                                                
Ellen                      80      11000                                                                                                                                                                
Eleni                      80      10500                                                                                                                                                                
Jonathon                   80       8600                                                                                                                                                                
Steven                     90      24000                                                                                                                                                                
Lex                        90      17000                                                                                                                                                                
Neena                      90      17000                                                                                                                                                                
Shelley                   110      12000                                                                                                                                                                
William                   110       8300                                                                                                                                                                
Kimerely                            7000                                                                                                                                                                

20 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY FIRST_NAME , DEPARTMENT_ID , SALARY;

FIRST_NAME      DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                    
--------------- ------------- ---------- -----------                                                                                                                                                    
Alexander                  60       9000        9000                                                                                                                                                    
Jennifer                   10       4400        4400                                                                                                                                                    
Michael                    20      13000       13000                                                                                                                                                    
Curtis                     50       3100        3100                                                                                                                                                    
Randall                    50       2600        2600                                                                                                                                                    
Eleni                      80      10500       10500                                                                                                                                                    
Ellen                      80      11000       11000                                                                                                                                                    
Steven                     90      24000       24000                                                                                                                                                    
Lex                        90      17000       17000                                                                                                                                                    
Kevin                      50       5800        5800                                                                                                                                                    
Pat                        20       6000        6000                                                                                                                                                    
Shelley                   110      12000       12000                                                                                                                                                    
William                   110       8300        8300                                                                                                                                                    
Neena                      90      17000       17000                                                                                                                                                    
Peter                      50       2500        2500                                                                                                                                                    
Bruce                      60       6000        6000                                                                                                                                                    
Jonathon                   80       8600        8600                                                                                                                                                    
Kimerely                            7000        7000                                                                                                                                                    
Diana                      60       4200        4200                                                                                                                                                    
Trenna                     50       3500        3500                                                                                                                                                    

20 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY FIRST_NAME , DEPARTMENT_ID , SALARY ORDER BY 2;

FIRST_NAME      DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                    
--------------- ------------- ---------- -----------                                                                                                                                                    
Jennifer                   10       4400        4400                                                                                                                                                    
Michael                    20      13000       13000                                                                                                                                                    
Pat                        20       6000        6000                                                                                                                                                    
Curtis                     50       3100        3100                                                                                                                                                    
Kevin                      50       5800        5800                                                                                                                                                    
Peter                      50       2500        2500                                                                                                                                                    
Randall                    50       2600        2600                                                                                                                                                    
Trenna                     50       3500        3500                                                                                                                                                    
Alexander                  60       9000        9000                                                                                                                                                    
Bruce                      60       6000        6000                                                                                                                                                    
Diana                      60       4200        4200                                                                                                                                                    
Eleni                      80      10500       10500                                                                                                                                                    
Ellen                      80      11000       11000                                                                                                                                                    
Jonathon                   80       8600        8600                                                                                                                                                    
Lex                        90      17000       17000                                                                                                                                                    
Neena                      90      17000       17000                                                                                                                                                    
Steven                     90      24000       24000                                                                                                                                                    
Shelley                   110      12000       12000                                                                                                                                                    
William                   110       8300        8300                                                                                                                                                    
Kimerely                            7000        7000                                                                                                                                                    

20 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) DEPT_MAX_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID DEPT_MAX_SAL                                                                                                                                                                              
------------- ------------                                                                                                                                                                              
                      7000                                                                                                                                                                              
           90        24000                                                                                                                                                                              
           20        13000                                                                                                                                                                              
          110        12000                                                                                                                                                                              
           50         5800                                                                                                                                                                              
           80        11000                                                                                                                                                                              
           60         9000                                                                                                                                                                              
           10         4400                                                                                                                                                                              

8 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) DEPT_MAX_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID ORDER BY 1;

DEPARTMENT_ID DEPT_MAX_SAL                                                                                                                                                                              
------------- ------------                                                                                                                                                                              
           10         4400                                                                                                                                                                              
           20        13000                                                                                                                                                                              
           50         5800                                                                                                                                                                              
           60         9000                                                                                                                                                                              
           80        11000                                                                                                                                                                              
           90        24000                                                                                                                                                                              
          110        12000                                                                                                                                                                              
                      7000                                                                                                                                                                              

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                    
--------------- ------------- ---------- -----------                                                                                                                                                    
Steven                     90      24000       24000                                                                                                                                                    
Neena                      90      17000       24000                                                                                                                                                    
Lex                        90      17000       24000                                                                                                                                                    
Alexander                  60       9000        9000                                                                                                                                                    
Bruce                      60       6000        9000                                                                                                                                                    
Diana                      60       4200        9000                                                                                                                                                    
Kevin                      50       5800        5800                                                                                                                                                    
Trenna                     50       3500        5800                                                                                                                                                    
Curtis                     50       3100        5800                                                                                                                                                    
Randall                    50       2600        5800                                                                                                                                                    
Peter                      50       2500        5800                                                                                                                                                    
Eleni                      80      10500       11000                                                                                                                                                    
Ellen                      80      11000       11000                                                                                                                                                    
Jonathon                   80       8600       11000                                                                                                                                                    
Jennifer                   10       4400        4400                                                                                                                                                    
Michael                    20      13000       13000                                                                                                                                                    
Pat                        20       6000       13000                                                                                                                                                    
Shelley                   110      12000       12000                                                                                                                                                    
William                   110       8300       12000                                                                                                                                                    

19 rows selected.

SQL> SELECT FIRST_NAME, E.DEPARTMENT_ID, SALARY, (SELECT MAX(SALARY) FROM EMPLOYEES D GROUP BY DEPARTMENT_ID HAVING NVL(D.DEPARTMENT_ID,0) = NVL(E.DEPARTMENT_ID,0)) DEPT_MAX_SAL FROM EMPLOYEES E;

FIRST_NAME      DEPARTMENT_ID     SALARY DEPT_MAX_SAL                                                                                                                                                   
--------------- ------------- ---------- ------------                                                                                                                                                   
Steven                     90      24000        24000                                                                                                                                                   
Neena                      90      17000        24000                                                                                                                                                   
Lex                        90      17000        24000                                                                                                                                                   
Alexander                  60       9000         9000                                                                                                                                                   
Bruce                      60       6000         9000                                                                                                                                                   
Diana                      60       4200         9000                                                                                                                                                   
Kevin                      50       5800         5800                                                                                                                                                   
Trenna                     50       3500         5800                                                                                                                                                   
Curtis                     50       3100         5800                                                                                                                                                   
Randall                    50       2600         5800                                                                                                                                                   
Peter                      50       2500         5800                                                                                                                                                   
Eleni                      80      10500        11000                                                                                                                                                   
Ellen                      80      11000        11000                                                                                                                                                   
Jonathon                   80       8600        11000                                                                                                                                                   
Kimerely                            7000         7000                                                                                                                                                   
Jennifer                   10       4400         4400                                                                                                                                                   
Michael                    20      13000        13000                                                                                                                                                   
Pat                        20       6000        13000                                                                                                                                                   
Shelley                   110      12000        12000                                                                                                                                                   
William                   110       8300        12000                                                                                                                                                   

20 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , DEPT_MAX_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) DEPT_MAX_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY DEPT_MAX_SAL                                                                                                                                                   
--------------- ------------- ---------- ------------                                                                                                                                                   
Steven                     90      24000        24000                                                                                                                                                   
Neena                      90      17000        24000                                                                                                                                                   
Lex                        90      17000        24000                                                                                                                                                   
Alexander                  60       9000         9000                                                                                                                                                   
Bruce                      60       6000         9000                                                                                                                                                   
Diana                      60       4200         9000                                                                                                                                                   
Kevin                      50       5800         5800                                                                                                                                                   
Trenna                     50       3500         5800                                                                                                                                                   
Curtis                     50       3100         5800                                                                                                                                                   
Randall                    50       2600         5800                                                                                                                                                   
Peter                      50       2500         5800                                                                                                                                                   
Eleni                      80      10500        11000                                                                                                                                                   
Ellen                      80      11000        11000                                                                                                                                                   
Jonathon                   80       8600        11000                                                                                                                                                   
Jennifer                   10       4400         4400                                                                                                                                                   
Michael                    20      13000        13000                                                                                                                                                   
Pat                        20       6000        13000                                                                                                                                                   
Shelley                   110      12000        12000                                                                                                                                                   
William                   110       8300        12000                                                                                                                                                   

19 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) DEPT_Max_sal FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID DEPT_MAX_SAL                                                                                                                                                                              
------------- ------------                                                                                                                                                                              
                      7000                                                                                                                                                                              
           90        24000                                                                                                                                                                              
           20        13000                                                                                                                                                                              
          110        12000                                                                                                                                                                              
           50         5800                                                                                                                                                                              
           80        11000                                                                                                                                                                              
           60         9000                                                                                                                                                                              
           10         4400                                                                                                                                                                              

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , DEPT_MAX_sal
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) dept_MAX_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY DEPT_MAX_SAL                                                                                                                                                   
--------------- ------------- ---------- ------------                                                                                                                                                   
Steven                     90      24000        24000                                                                                                                                                   
Neena                      90      17000        24000                                                                                                                                                   
Lex                        90      17000        24000                                                                                                                                                   
Alexander                  60       9000         9000                                                                                                                                                   
Bruce                      60       6000         9000                                                                                                                                                   
Diana                      60       4200         9000                                                                                                                                                   
Kevin                      50       5800         5800                                                                                                                                                   
Trenna                     50       3500         5800                                                                                                                                                   
Curtis                     50       3100         5800                                                                                                                                                   
Randall                    50       2600         5800                                                                                                                                                   
Peter                      50       2500         5800                                                                                                                                                   
Eleni                      80      10500        11000                                                                                                                                                   
Ellen                      80      11000        11000                                                                                                                                                   
Jonathon                   80       8600        11000                                                                                                                                                   
Jennifer                   10       4400         4400                                                                                                                                                   
Michael                    20      13000        13000                                                                                                                                                   
Pat                        20       6000        13000                                                                                                                                                   
Shelley                   110      12000        12000                                                                                                                                                   
William                   110       8300        12000                                                                                                                                                   

19 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) "DEPT_Max_sal" FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID DEPT_Max_sal                                                                                                                                                                              
------------- ------------                                                                                                                                                                              
                      7000                                                                                                                                                                              
           90        24000                                                                                                                                                                              
           20        13000                                                                                                                                                                              
          110        12000                                                                                                                                                                              
           50         5800                                                                                                                                                                              
           80        11000                                                                                                                                                                              
           60         9000                                                                                                                                                                              
           10         4400                                                                                                                                                                              

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "DEPT_Max_sal"
  2  FROM EMPLOYEES
  3  NATURAL JOIN ( SELECT DEPARTMENT_ID , MAX(SALARY) "DEPT_Max_sal" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME      DEPARTMENT_ID     SALARY DEPT_Max_sal                                                                                                                                                   
--------------- ------------- ---------- ------------                                                                                                                                                   
Steven                     90      24000        24000                                                                                                                                                   
Neena                      90      17000        24000                                                                                                                                                   
Lex                        90      17000        24000                                                                                                                                                   
Alexander                  60       9000         9000                                                                                                                                                   
Bruce                      60       6000         9000                                                                                                                                                   
Diana                      60       4200         9000                                                                                                                                                   
Kevin                      50       5800         5800                                                                                                                                                   
Trenna                     50       3500         5800                                                                                                                                                   
Curtis                     50       3100         5800                                                                                                                                                   
Randall                    50       2600         5800                                                                                                                                                   
Peter                      50       2500         5800                                                                                                                                                   
Eleni                      80      10500        11000                                                                                                                                                   
Ellen                      80      11000        11000                                                                                                                                                   
Jonathon                   80       8600        11000                                                                                                                                                   
Jennifer                   10       4400         4400                                                                                                                                                   
Michael                    20      13000        13000                                                                                                                                                   
Pat                        20       6000        13000                                                                                                                                                   
Shelley                   110      12000        12000                                                                                                                                                   
William                   110       8300        12000                                                                                                                                                   

19 rows selected.

SQL> REM 1 DISPLAY LAST_NAME , JOB_ID , SALARY , JOB MINIMUM SALARY (WITHOUT USING COLUMN ALIAS)
SQL> 
SQL> REM 2 DISPLAY FIRST_NAME , MANAGER_ID , SALARY , MANAGER_ID HIGHEST SALARY (USING CASE INSENSITIVE COLUMN ALIAS)
SQL> 
SQL> REM 3 DISPLAY FULL NAME , DEPARTMENT_ID , SALARY, DEPT_Min_salary , dept_maX_SALARY  ( USING CASE SENSITIVE COLUMN ALIASES )
SQL> 
SQL> SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES NATURAL JOIN
  3  (SELECT JOB_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME       JOB_ID         SALARY MIN(SALARY)                                                                                                                                                       
--------------- ---------- ---------- -----------                                                                                                                                                       
King            AD_PRES         24000       24000                                                                                                                                                       
Kochhar         AD_VP           17000       17000                                                                                                                                                       
De Haan         AD_VP           17000       17000                                                                                                                                                       
Hunold          IT_PROG          9000        4200                                                                                                                                                       
Ernst           IT_PROG          6000        4200                                                                                                                                                       
Lorentz         IT_PROG          4200        4200                                                                                                                                                       
Mourgos         ST_MAN           5800        5800                                                                                                                                                       
Rajs            ST_CLERK         3500        2500                                                                                                                                                       
Davies          ST_CLERK         3100        2500                                                                                                                                                       
Matos           ST_CLERK         2600        2500                                                                                                                                                       
Vargas          ST_CLERK         2500        2500                                                                                                                                                       
Zlotkey         SA_MAN          10500       10500                                                                                                                                                       
Abel            SA_REP          11000        7000                                                                                                                                                       
Taylor          SA_REP           8600        7000                                                                                                                                                       
Grant           SA_REP           7000        7000                                                                                                                                                       
Whalen          AD_ASST          4400        4400                                                                                                                                                       
Hartstein       MK_MAN          13000       13000                                                                                                                                                       
Fay             MK_REP           6000        6000                                                                                                                                                       
Higgins         AC_MGR          12000       12000                                                                                                                                                       
Gietz           AC_ACCOUNT       8300        8300                                                                                                                                                       

20 rows selected.

SQL> 
SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , hig_SALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN
  4  (SELECT MANAGER_ID , MAX(SALARY) HIG_SALARY FROM EMPLOYEES GROUP BY MANAGER_ID);

FIRST_NAME      MANAGER_ID     SALARY HIG_SALARY                                                                                                                                                        
--------------- ---------- ---------- ----------                                                                                                                                                        
Neena                  100      17000      17000                                                                                                                                                        
Lex                    100      17000      17000                                                                                                                                                        
Alexander              102       9000       9000                                                                                                                                                        
Bruce                  103       6000       6000                                                                                                                                                        
Diana                  103       4200       6000                                                                                                                                                        
Kevin                  100       5800      17000                                                                                                                                                        
Trenna                 124       3500       3500                                                                                                                                                        
Curtis                 124       3100       3500                                                                                                                                                        
Randall                124       2600       3500                                                                                                                                                        
Peter                  124       2500       3500                                                                                                                                                        
Eleni                  100      10500      17000                                                                                                                                                        
Ellen                  149      11000      11000                                                                                                                                                        
Jonathon               149       8600      11000                                                                                                                                                        
Kimerely               149       7000      11000                                                                                                                                                        
Jennifer               101       4400      12000                                                                                                                                                        
Michael                100      13000      17000                                                                                                                                                        
Pat                    201       6000       6000                                                                                                                                                        
Shelley                101      12000      12000                                                                                                                                                        
William                205       8300       8300                                                                                                                                                        

19 rows selected.

SQL> 
SQL> SELECT FIRST_NAME ||' '|| LAST_NAME "FULL NAME" , DEPARTMENT_ID , SALARY, "DEPT_Min_salary" , "dept_maX_SALARY"
  2  FROM EMPLOYEES
  3  NATURAL JOIN
  4  (SELECT  DEPARTMENT_ID , MIN(SALARY) "DEPT_Min_salary" , MAX(SALARY) "dept_maX_SALARY" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FULL NAME                       DEPARTMENT_ID     SALARY DEPT_Min_salary dept_maX_SALARY                                                                                                                
------------------------------- ------------- ---------- --------------- ---------------                                                                                                                
Steven King                                90      24000           17000           24000                                                                                                                
Neena Kochhar                              90      17000           17000           24000                                                                                                                
Lex De Haan                                90      17000           17000           24000                                                                                                                
Alexander Hunold                           60       9000            4200            9000                                                                                                                
Bruce Ernst                                60       6000            4200            9000                                                                                                                
Diana Lorentz                              60       4200            4200            9000                                                                                                                
Kevin Mourgos                              50       5800            2500            5800                                                                                                                
Trenna Rajs                                50       3500            2500            5800                                                                                                                
Curtis Davies                              50       3100            2500            5800                                                                                                                
Randall Matos                              50       2600            2500            5800                                                                                                                
Peter Vargas                               50       2500            2500            5800                                                                                                                
Eleni Zlotkey                              80      10500            8600           11000                                                                                                                
Ellen Abel                                 80      11000            8600           11000                                                                                                                
Jonathon Taylor                            80       8600            8600           11000                                                                                                                
Jennifer Whalen                            10       4400            4400            4400                                                                                                                
Michael Hartstein                          20      13000            6000           13000                                                                                                                
Pat Fay                                    20       6000            6000           13000                                                                                                                
Shelley Higgins                           110      12000            8300           12000                                                                                                                
William Gietz                             110       8300            8300           12000                                                                                                                

19 rows selected.

SQL> SPOOL OFF
